document.addEventListener("DOMContentLoaded", function () {
  const e = document.querySelectorAll(".nav-link");
  e.forEach((e) => {
    e.addEventListener("click", function (e) {
      const t = this.getAttribute("href");
      if (t.startsWith("#")) {
        e.preventDefault();
        const n = t.substring(1),
          a = document.getElementById(n);
        if (a) {
          a.scrollIntoView({ behavior: "smooth", block: "start" });
          const e = document.querySelector(".navbar-collapse");
          if (e.classList.contains("show")) {
            new bootstrap.Collapse(e).hide();
          }
        }
      }
    });
  });
  const t = document.querySelectorAll("section[id]");
  function n() {
    const e = window.pageYOffset;
    t.forEach((t) => {
      const n = t.offsetHeight,
        a = t.offsetTop - 100,
        o = t.getAttribute("id"),
        l = document.querySelector(`.nav-link[href="#${o}"]`);
      l && e > a && e <= a + n
        ? l.classList.add("active")
        : l && l.classList.remove("active");
    });
  }
  window.addEventListener("scroll", n);
  if (typeof GLightbox !== "undefined") {
    GLightbox({
      selector: ".glightbox",
      touchNavigation: !0,
      loop: !0,
      autoplayVideos: !1,
    });
  }
  const a = document.querySelectorAll(".gallery-filters .btn"),
    o = document.querySelectorAll(".gallery-item");
  a.forEach((e) => {
    e.addEventListener("click", function () {
      a.forEach((e) => e.classList.remove("active"));
      this.classList.add("active");
      const t = this.getAttribute("data-filter");
      o.forEach((e) => {
        const n = e.getAttribute("data-category") || e.getAttribute("data-type");
        if (t === "all") {
          e.style.opacity = "0";
          setTimeout(() => {
            e.style.display = "block";
            setTimeout(() => {
              e.style.opacity = "1";
            }, 10);
          }, 150);
        } else if (n === t) {
          e.style.opacity = "0";
          setTimeout(() => {
            e.style.display = "block";
            setTimeout(() => {
              e.style.opacity = "1";
            }, 10);
          }, 150);
        } else {
          e.style.opacity = "0";
          setTimeout(() => {
            e.style.display = "none";
          }, 300);
        }
      });
    });
  });
  const l = document.querySelectorAll(".step-details");
  l.forEach((e) => {
    e.addEventListener("show.bs.collapse", function () {
      const e = this.previousElementSibling,
        t = e.querySelector(".collapse-toggle i");
      t && (t.style.transform = "rotate(0deg)");
    });
    e.addEventListener("hide.bs.collapse", function () {
      const e = this.previousElementSibling,
        t = e.querySelector(".collapse-toggle i");
      t && (t.style.transform = "rotate(180deg)");
    });
  });
  const s = document.getElementById("navbar");
  function c() {
    window.scrollY > 50
      ? s.classList.add("scrolled")
      : s.classList.remove("scrolled");
  }
  window.addEventListener("scroll", c);
  c();
});


// Gallery audio functionality has been moved to the dedicated gallery.html page

// Enhanced Pilgrimage Details - Sleek Sidebar Functionality
document.addEventListener('DOMContentLoaded', function() {
  const sidebar = document.getElementById('details-sidebar');
  const detailsSection = document.getElementById('details');
  const detailsContent = document.querySelector('.details-content');
  const sidebarProgressBar = document.getElementById('sidebar-progress');
  
  // Create sidebar toggle button
  const sidebarToggle = document.createElement('button');
  sidebarToggle.className = 'sidebar-toggle';
  sidebarToggle.innerHTML = '<i class="bi bi-list"></i>';
  sidebarToggle.title = 'Open Navigation';
  document.body.appendChild(sidebarToggle);
  
  // Create overlay for mobile
  const overlay = document.createElement('div');
  overlay.className = 'sidebar-overlay';
  document.body.appendChild(overlay);
  
  // Toggle sidebar
  function toggleSidebar() {
    sidebar.classList.toggle('active');
    overlay.classList.toggle('active');
    
    if (window.innerWidth > 1024) {
      detailsContent.classList.toggle('sidebar-open');
    }
    
    // Update toggle button icon
    const icon = sidebarToggle.querySelector('i');
    if (sidebar.classList.contains('active')) {
      icon.className = 'bi bi-x';
      sidebarToggle.title = 'Close Navigation';
    } else {
      icon.className = 'bi bi-list';
      sidebarToggle.title = 'Open Navigation';
    }
  }
  
  sidebarToggle.addEventListener('click', toggleSidebar);
  overlay.addEventListener('click', toggleSidebar);
  
  // Show/Hide sidebar toggle based on scroll position
  function toggleSidebarButton() {
    if (detailsSection) {
      const sectionTop = detailsSection.offsetTop;
      const sectionBottom = sectionTop + detailsSection.offsetHeight;
      const scrollTop = window.pageYOffset;
      const windowHeight = window.innerHeight;
      
      // Check if user is in the details section
      if (scrollTop + windowHeight > sectionTop && scrollTop < sectionBottom) {
        sidebarToggle.classList.add('visible');
        sidebar.classList.add('show');
      } else {
        sidebarToggle.classList.remove('visible');
        sidebar.classList.remove('show');
        // Auto-close sidebar when scrolling away
        if (sidebar.classList.contains('active')) {
          toggleSidebar();
        }
      }
    }
  }
  
  window.addEventListener('scroll', toggleSidebarButton);
  
  // Sidebar Progress Bar
  function updateSidebarProgress() {
    if (detailsSection && sidebarProgressBar) {
      const sectionTop = detailsSection.offsetTop;
      const sectionHeight = detailsSection.offsetHeight;
      const scrollTop = window.pageYOffset;
      const windowHeight = window.innerHeight;
      
      const sectionStart = sectionTop - windowHeight;
      const sectionEnd = sectionTop + sectionHeight;
      
      if (scrollTop >= sectionStart && scrollTop <= sectionEnd) {
        const progress = ((scrollTop - sectionStart) / (sectionEnd - sectionStart)) * 100;
        sidebarProgressBar.style.width = Math.min(Math.max(progress, 0), 100) + '%';
      }
    }
  }
  
  window.addEventListener('scroll', updateSidebarProgress);
  
  // Active Sidebar Link Highlighting
  const sidebarLinks = document.querySelectorAll('.sidebar-link');
  const sections = document.querySelectorAll('.detail-section');
  
  function updateActiveSidebarLink() {
    let currentSection = '';
    
    sections.forEach(section => {
      const sectionTop = section.offsetTop - 200;
      if (window.pageYOffset >= sectionTop) {
        currentSection = section.getAttribute('id');
      }
    });
    
    sidebarLinks.forEach(link => {
      link.classList.remove('active');
      if (link.getAttribute('data-section') === currentSection) {
        link.classList.add('active');
      }
    });
  }
  
  window.addEventListener('scroll', updateActiveSidebarLink);
  
  // Smooth Scrolling for Sidebar Links
  sidebarLinks.forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const targetId = this.getAttribute('data-section');
      const targetSection = document.getElementById(targetId);
      
      if (targetSection) {
        targetSection.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
        
        // Auto-close sidebar on mobile after clicking
        if (window.innerWidth <= 1024) {
          setTimeout(() => {
            toggleSidebar();
          }, 300);
        }
      }
    });
  });
  
  // Handle window resize
  window.addEventListener('resize', function() {
    if (window.innerWidth > 1024) {
      overlay.classList.remove('active');
    } else {
      detailsContent.classList.remove('sidebar-open');
    }
  });
  
  // Enhanced Section Highlighting on Direct Link Access
  function highlightSectionFromHash() {
    const hash = window.location.hash;
    if (hash) {
      const targetSection = document.querySelector(hash);
      if (targetSection && targetSection.classList.contains('detail-section')) {
        setTimeout(() => {
          targetSection.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }, 100);
      }
    }
  }
  
  // Handle hash changes
  window.addEventListener('hashchange', highlightSectionFromHash);
  highlightSectionFromHash(); // Check on page load
});
//New Gallery Group Navigation
document.addEventListener('DOMContentLoaded', function() {
  // Handle gallery group card clicks
  const galleryGroupCards = document.querySelectorAll('.gallery-group-card[data-group]');
  
  galleryGroupCards.forEach(card => {
    card.addEventListener('click', function() {
      const groupId = this.getAttribute('data-group');
      
      if (groupId === 'tozan-nov-2025') {
        // Navigate to the dedicated gallery page
        window.location.href = 'gallery.html';
      } else if (groupId === 'tozan-aug-2023') {
        // Navigate to the 2023 gallery page
        window.location.href = 'gallery-2023.html';
      }
    });
    
    // Also handle the view button specifically
    const viewBtn = card.querySelector('.gallery-view-btn');
    if (viewBtn) {
      viewBtn.addEventListener('click', function(e) {
        e.stopPropagation(); // Prevent card click
        const groupId = this.closest('.gallery-group-card').getAttribute('data-group');
        
        if (groupId === 'tozan-nov-2025') {
          window.location.href = 'gallery.html';
        } else if (groupId === 'tozan-aug-2023') {
          window.location.href = 'gallery-2023.html';
        }
      });
    }
  });
  
  // Add hover effects for better UX
  galleryGroupCards.forEach(card => {
    card.addEventListener('mouseenter', function() {
      this.style.transform = 'translateY(-10px)';
    });
    
    card.addEventListener('mouseleave', function() {
      this.style.transform = 'translateY(0)';
    });
  });
});// Navba
// Enhanced Navbar Scroll Effect - Transparent only in #home section
document.addEventListener('DOMContentLoaded', function() {
  const navbar = document.getElementById('navbar');
  const homeSection = document.getElementById('home');
  
  if (navbar && homeSection) {
    function handleNavbarScroll() {
      const scrollPosition = window.scrollY || window.pageYOffset;
      const homeSectionHeight = homeSection.offsetHeight;
      const homeSectionTop = homeSection.offsetTop;
      
      // Check if we're still in the home section
      const isInHomeSection = scrollPosition < (homeSectionTop + homeSectionHeight - 100);
      
      if (isInHomeSection) {
        // In home section - keep transparent
        navbar.classList.remove('scrolled');
      } else {
        // Outside home section - add black background
        navbar.classList.add('scrolled');
      }
    }
    
    // Add scroll event listener with throttling
    let ticking = false;
    function requestTick() {
      if (!ticking) {
        requestAnimationFrame(handleNavbarScroll);
        ticking = true;
        setTimeout(() => { ticking = false; }, 16);
      }
    }
    
    window.addEventListener('scroll', requestTick);
    
    // Check initial state
    handleNavbarScroll();
    
    console.log('Navbar section-based scroll effect initialized');
  } else {
    console.error('Navbar or home section not found');
  }
});