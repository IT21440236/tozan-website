<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tozan November 2025 Gallery - Pilgrimage Memories</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <!-- GLightbox CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="assets/css/style.css">

  <style>
    .gallery-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 4rem 0 2rem;
      margin-bottom: 3rem;
    }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-top: 2rem;
    }

    .gallery-item {
      position: relative;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
      aspect-ratio: 1;
    }

    .gallery-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
    }

    .gallery-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .gallery-item:hover img {
      transform: scale(1.05);
    }

    .gallery-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .gallery-item:hover .gallery-overlay {
      opacity: 1;
    }

    .gallery-overlay i {
      color: white;
      font-size: 2rem;
    }

    .loading-spinner {
      text-align: center;
      padding: 3rem;
    }

    .back-btn {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 1000;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
    }
  </style>
</head>

<body>
  <!-- Back Button -->
  <a href="index.html#gallery" class="btn btn-primary back-btn">
    <i class="bi bi-arrow-left"></i> Back to Main
  </a>

  <!-- Gallery Header -->
  <div class="gallery-header">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-8">
          <h1><i class="bi bi-camera-fill me-3"></i>Tozan November 2025</h1>
          <p class="lead mb-0">Sacred pilgrimage memories from our journey to Taisekiji Head Temple</p>
        </div>
        <div class="col-md-4 text-md-end">
          <div class="gallery-stats">
            <span class="badge bg-light text-dark me-2 fs-6">
              <i class="bi bi-images"></i> <span id="photo-count">Loading...</span> Photos
            </span>
            <span class="badge bg-light text-dark fs-6">
              <i class="bi bi-geo-alt"></i> Japan
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Gallery Content -->
  <div class="container">
    <!-- Loading Spinner -->
    <div id="loading" class="loading-spinner">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading photos...</span>
      </div>
      <p class="mt-3">Loading beautiful memories from Cloudflare...</p>
    </div>

    <!-- Gallery Grid -->
    <div id="gallery-grid" class="gallery-grid" style="display: none;">
      <!-- Images will be loaded dynamically here -->
    </div>

    <!-- Error Message -->
    <div id="error-message" class="alert alert-warning" style="display: none;">
      <h5><i class="bi bi-exclamation-triangle"></i> Unable to load photos</h5>
      <p>We're having trouble loading the gallery from Cloudflare. Please try refreshing the page.</p>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- GLightbox JS -->
  <script src="https://cdn.jsdelivr.net/npm/glightbox/dist/js/glightbox.min.js"></script>

  <script>
    // Cloudflare R2 Configuration
    const CLOUDFLARE_BASE_URL = 'https://pub-b6d85dc4453b487d879f35b1669c3da2.r2.dev/images/';

    // Common image extensions
    const IMAGE_EXTENSIONS = ['jpg', 'jpeg', 'png', 'webp', 'gif'];

    // Comprehensive image list based on your Cloudflare R2 bucket
    // Generated from the patterns visible in your bucket
    const KNOWN_IMAGES = [
      // Members photos
      'member-near-water-fall-at-fujiyen-hotel-1.jpg', 'member-near-water-fall-at-fujiyen-hotel-2.jpg',
      'member-near-water-fall-at-fujiyen-hotel-3.jpg', 'member-near-water-fall-at-fujiyen-hotel-4.jpg',

      // Temple and premises
      'temple-1.jpg', 'temple-2.jpg', 'temple-3.jpg', 'temple-4.jpg',
      'headtemple-1.jpg', 'headtemple-2.jpg', 'headtemple-3.jpg', 'headtemple-4.jpg', 'headtemple-5.jpg',
      'headtemple-6.jpg', 'headtemple-7.jpg', 'headtemple-8.jpg', 'headtemple-9.jpg', 'headtemple-10.jpg',
      'headtemple-11.jpg', 'headtemple-12.jpg', 'headtemple-13.jpg', 'headtemple-14.jpg', 'headtemple-15.jpg', 'headtemple-16.jpg',

      // Mount Fuji
      'mount-fuji-1.jpg', 'mount-fuji-2.jpg', 'mount-fuji-3.jpg', 'mount-fuji-4.jpg', 'mount-fuji-5.jpg',
      'mount-fuji-6.jpg', 'mount-fuji-7.jpg', 'mount-fuji-8.jpg', 'mount-fuji-9.jpg', 'mount-fuji-10.jpg',
      'mount-fuji-11.jpg', 'mount-fuji-12.jpg',

      // Hotels and accommodation
      'narita-tobu-hotel-1.jpg', 'narita-tobu-hotel-2.jpg', 'narita-tobu-hotel-3.jpg', 'narita-tobu-hotel-4.jpg',
      'narita-tobu-hotel-5.jpg', 'narita-tobu-hotel-6.jpg', 'narita-tobu-hotel-7.jpg', 'narita-tobu-hotel-8.jpg',
      'narita-tobu-hotel-9.jpg', 'narita-tobu-hotel-10.jpg', 'narita-tobu-hotel-11.jpg',
      'fujiyen-hotel-1.jpg', 'fujiyen-hotel-2.jpg', 'fujiyen-hotel-3.jpg', 'fujiyen-hotel-4.jpg',
      'fujiyen-hotel-at-night.jpg',

      // Travel and journey
      'hongkong-airport-1.jpg', 'hongkong-airport-2.jpg', 'hongkong-airport-3.jpg', 'hongkong-airport-4.jpg', 'hongkong-airport-5.jpg',
      'cathay-pacific-cmb-hongkong-meal-2.jpg', 'cathay-pacific-window-view-2.jpg', 'cathay-pacific-window-view-3.jpg',
      'cx-520.jpg', 'hongkong-landed.jpg', 'narita-airport.jpg', 'narita-airport-pickup-vehicle.jpg',

      // Temple activities
      'tokohibo-1.jpg', 'tokohibo-2.jpg', 'tokohibo-3.jpg', 'tokohibo-4.jpg', 'tokohibo-5.jpg',
      'tokohibo-6.jpg', 'tokohibo-8.jpg', 'tokohibo-9.jpg', 'tokohibo-10.jpg', 'tokohibo-11.jpg',
      'tokohibo-12.jpg', 'tokohibo-13.jpg', 'tokohibo-14.jpg', 'tokohibo-15.jpg', 'tokohibo-16.jpg',
      'seikado-1.jpg', 'seikado-2.jpg', 'seikado-3.jpg',

      // Local sights and misc
      'fujinomiya-streets-1.jpg', 'fujinomiya-streets-2.jpg', 'fujinomiya-streets-3.jpg',
      'waterfall-near-fujiyen-hotel.jpg', 'vending-machine.jpg', 'ice-cream-vending-machine.jpg',
      'tree.jpg', 'wagon-r-1.jpg', 'wagon-r-2.jpg'
    ];

    // Function to create comprehensive image list
    function generateImageList() {
      const images = [];

      // Add known images
      images.push(...KNOWN_IMAGES);

      // Generate numbered variations for member photos
      for (let i = 1; i <= 56; i++) {
        images.push(`members-${i}.jpg`);
      }

      // Generate temple premises variations
      for (let i = 1; i <= 62; i++) {
        images.push(`temple-premises-${i}.jpg`);
      }

      // Generate ceremony day variations
      for (let i = 1; i <= 27; i++) {
        images.push(`members-ceremony-day-${i}.jpg`);
      }

      // Generate various member activity variations
      const memberActivities = [
        'members-at-aeon-mall-fujinomiya-', 'members-at-fujinomiya-streets-',
        'members-at-fujiyen-dinning-', 'members-at-head-temple-', 'members-at-seikado-',
        'members-at-tokohibo-', 'members-at-treasury-hall-', 'members-departing-fujiyen-hotel-for-ceremony-',
        'members-last-day-at-tokohibo-', 'narita-tobu-hotel-members-leaving-'
      ];

      memberActivities.forEach(pattern => {
        for (let i = 1; i <= 11; i++) {
          images.push(`${pattern}${i}.jpg`);
        }
      });

      // Add other specific images
      const otherImages = [
        'aeon-mall-fujinomiya-1.jpg', 'aeon-mall-fujinomiya-2.jpg',
        'aeon-mall-fujinomiya-taxfree-shopping-guide-1.jpg',
        'butsugu-shop.jpg', 'fast-charging-at-hongkong-airport.jpg',
        'first-night-dinner-1.jpg', 'first-night-dinner-2.jpg',
        'fuji-drainage-1.jpg', 'fuji-drainage-2.jpg',
        'gokai-list.jpg', 'gokai-tickets.jpg', 'head-temple-1.jpg', 'head-temple-2.jpg',
        'map-of-taisekiji.jpg', 'members-buying-gokai-ticekts.jpg',
        'members-taking-shortcut-to-temple.jpg', 'on-the-way-to-fujinomiya.jpg',
        'pagoda-1.jpg', 'pagoda-2.jpg', 'salmon-gate-1.jpg', 'salmon-gate-2.jpg',
        'salmon-gate-3.jpg', 'salmon-gate-4.jpg', 'salmon-gate-5.jpg', 'salmon-gate-6.jpg',
        'seven-eleven-foods-1.jpg', 'seven-eleven-foods-3.jpg', 'sl-food-at-fujiyen.jpg',
        'tokohibo-dinning-1.jpg', 'tokohibo-dinning-2.jpg', 'tokohibo-dinning-3.jpg', 'tokohibo-dinning-4.jpg',
        'tokohibo-shoes-on-off-area.jpg', 'treasury-hall-2.jpg', 'treasury-hall-3.jpg',
        'treasury-hall-4.jpg', 'treasury-hall-5.jpg'
      ];

      images.push(...otherImages);

      return [...new Set(images)]; // Remove duplicates
    }

    // Function to check if image exists
    async function imageExists(url) {
      try {
        const response = await fetch(url, { method: 'HEAD' });
        return response.ok;
      } catch {
        return false;
      }
    }

    // Function to load gallery images
    async function loadGallery() {
      const galleryGrid = document.getElementById('gallery-grid');
      const loading = document.getElementById('loading');
      const errorMessage = document.getElementById('error-message');
      const photoCount = document.getElementById('photo-count');

      try {
        const imageList = generateImageList();
        const validImages = [];

        // Check which images exist (limit to first 50 for performance)
        const imagesToCheck = imageList.slice(0, 100);

        for (const imageName of imagesToCheck) {
          const imageUrl = CLOUDFLARE_BASE_URL + imageName;
          if (await imageExists(imageUrl)) {
            validImages.push({
              name: imageName,
              url: imageUrl,
              alt: imageName.replace(/[-_]/g, ' ').replace('.jpg', '').replace('.jpeg', '').replace('.png', '')
            });
          }

          // Update count as we find images
          photoCount.textContent = validImages.length;
        }

        if (validImages.length === 0) {
          throw new Error('No images found');
        }

        // Create gallery items
        validImages.forEach((image, index) => {
          const galleryItem = document.createElement('div');
          galleryItem.className = 'gallery-item';
          galleryItem.innerHTML = `
            <a href="${image.url}" class="glightbox" data-gallery="tozan-gallery">
              <img src="${image.url}" alt="${image.alt}" loading="lazy" />
              <div class="gallery-overlay">
                <i class="bi bi-zoom-in"></i>
              </div>
            </a>
          `;
          galleryGrid.appendChild(galleryItem);
        });

        // Initialize lightbox
        const lightbox = GLightbox({
          touchNavigation: true,
          loop: true,
          autoplayVideos: false,
        });

        // Show gallery
        loading.style.display = 'none';
        galleryGrid.style.display = 'grid';

      } catch (error) {
        console.error('Error loading gallery:', error);
        loading.style.display = 'none';
        errorMessage.style.display = 'block';
      }
    }

    // Load gallery when page loads
    document.addEventListener('DOMContentLoaded', loadGallery);
  </script>
</body>

</html>